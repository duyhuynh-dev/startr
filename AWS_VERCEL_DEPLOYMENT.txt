â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  AWS LIGHTSAIL + VERCEL DEPLOYMENT - $5/month TOTAL!        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

COST BREAKDOWN:
===============
â€¢ AWS Lightsail (1GB RAM):    $5/month
â€¢ Vercel (Frontend):          FREE
â€¢ AWS S3 (Storage):           FREE (first 5GB)
â€¢ TOTAL:                      $5/month â­ CHEAPEST OPTION!


STEP 1: CREATE AWS LIGHTSAIL INSTANCE
======================================
1. Go to: https://lightsail.aws.amazon.com
2. Click "Create instance"
3. Choose:
   - Platform: Linux/Unix
   - Blueprint: Ubuntu 22.04 LTS
   - Instance plan: $5/month (1GB RAM, 1 vCPU) â­
4. Click "Create instance"

STEP 2: CONNECT TO YOUR INSTANCE
=================================
1. Click on your instance in Lightsail console
2. Click "Connect using SSH" (opens browser terminal)
   OR use SSH from your computer:
   ssh -i ~/.ssh/your-key.pem ubuntu@your-instance-ip

STEP 3: INSTALL DOCKER
======================
# Update system
sudo apt update && sudo apt upgrade -y

# Install Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker ubuntu

# Install Docker Compose
sudo apt install docker-compose git -y

# Log out and back in for docker group to take effect
exit

STEP 4: CLONE YOUR REPO
========================
# SSH back in, then:
git clone YOUR_GITHUB_REPO_URL
cd ambitious-project/backend
cp .env.example .env
nano .env  # Fill in your passwords

STEP 5: CONFIGURE ENVIRONMENT
==============================
In backend/.env, set:

POSTGRES_PASSWORD=your-password
REDIS_PASSWORD=your-password
SECRET_KEY=your-secret-key
MINIO_ROOT_PASSWORD=your-password

# For AWS S3 instead of MinIO (optional):
STORAGE_TYPE=s3
AWS_ACCESS_KEY_ID=your-aws-key
AWS_SECRET_ACCESS_KEY=your-aws-secret
AWS_S3_BUCKET=your-bucket-name
AWS_REGION=us-east-1

# CORS - Set to your Vercel URL later:
CORS_ORIGINS=["https://your-app.vercel.app"]
FRONTEND_URL=https://your-app.vercel.app

STEP 6: DEPLOY BACKEND
======================
cd ..
./deploy-aws-lightsail.sh

STEP 7: CONFIGURE FIREWALL
===========================
In Lightsail console:
1. Go to your instance â†’ Networking
2. Add firewall rule:
   - Application: Custom
   - Protocol: TCP
   - Port: 8000
   - Click "Add rule"

STEP 8: GET YOUR INSTANCE IP
=============================
In Lightsail console, find your instance's public IP
This is your backend URL: http://YOUR_IP:8000


STEP 9: DEPLOY FRONTEND TO VERCEL
==================================
1. Go to: https://vercel.com
2. Sign up/login with GitHub
3. Click "Add New" â†’ "Project"
4. Import your repository
5. Configure:
   - Framework Preset: Next.js
   - Root Directory: frontend
   - Build Command: npm run build (or leave default)
   - Output Directory: .next (or leave default)

6. Add Environment Variables:
   NEXT_PUBLIC_API_URL=http://YOUR_LIGHTSAIL_IP:8000/api/v1
   NEXT_PUBLIC_WS_URL=ws://YOUR_LIGHTSAIL_IP:8000/api/v1/realtime/ws

7. Click "Deploy"

STEP 10: UPDATE CORS AFTER VERCEL DEPLOY
=========================================
Once Vercel gives you a URL (like your-app.vercel.app):

1. SSH into Lightsail:
   ssh ubuntu@YOUR_IP

2. Edit backend/.env:
   CORS_ORIGINS=["https://your-app.vercel.app"]

3. Restart backend:
   cd ambitious-project
   docker-compose -f docker-compose.prod.yml restart backend


OPTIONAL: USE AWS S3 FOR STORAGE
=================================
Instead of MinIO, use AWS S3 (first 5GB free):

1. Create S3 bucket in AWS Console
2. Create IAM user with S3 access
3. Add to backend/.env:
   STORAGE_TYPE=s3
   AWS_ACCESS_KEY_ID=your-key
   AWS_SECRET_ACCESS_KEY=your-secret
   AWS_S3_BUCKET=your-bucket-name
   AWS_REGION=us-east-1

4. Remove MinIO from docker-compose.prod.yml (optional)


TROUBLESHOOTING
===============
Can't connect?
- Check firewall rules in Lightsail console
- Make sure port 8000 is open

Backend won't start?
- Check logs: docker-compose -f docker-compose.prod.yml logs backend
- Verify .env file has all required values

Frontend can't connect?
- Check CORS_ORIGINS includes your Vercel URL
- Verify backend IP is correct
- Check firewall allows connections


That's it! You're deployed for $5/month! ğŸ‰

